% test_mexTripleSHProdReal.m

L = 4;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
nG = [6,12,18,24,30,42,56,72,90,110];
fprintf(1,'Done for... ');
for n=1:length(nG)
    Gi    = designGradients( nG(n) );
    SH{n} = GenerateSHMatrix( 2*L, Gi ); %#ok<SAGROW>
    fprintf(1,' %i',nG(n));
end
fprintf(1,'\n');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for l3=0:2:2*L
    for m3=-l3:l3
        z = (l3-1)*l3/2+(l3+m3+1);
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        for l2=0:2:L
            for m2=-l2:l2
                y = (l2-1)*l2/2+(l2+m2+1);
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                for l1=0:2:L
                    for m1=-l1:l1
                        x = (l1-1)*l1/2+(l1+m1+1);
                        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                        sh3prod = mexTripleSHProdReal(l1,l2,l3,m1,m2,m3);
                        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                        if( abs(sh3prod)<10*eps )
                            continue;
                        end
                        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                        approx = zeros(1,length(nG));
                        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                        for n=1:length(nG)
                            sh = SH{n};
                            Ylm1 = sh(:,x);
                            Ylm2 = sh(:,y);
                            Ylm3 = sh(:,z);
                            approx(n) = sum(Ylm1.*Ylm2.*Ylm3)*4*pi/size(sh,1);
                            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                        end
                        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                        close(figure(1));
                        hf1 = figure(1);
                        grid('on');
                        hold('on');
                        plot( nG, sh3prod*ones(size(nG)), 'LineWidth', 2, 'LineStyle','--','Color', [.0,.5,.0] );
                        plot( nG, real(approx), 'LineWidth', 1, 'LineStyle','-','Color', [.5,.0,.5] );
                        plot( nG, imag(approx), 'LineWidth', 1, 'LineStyle','-','Color', [.5,.5,.0] );
                        title(sprintf('( (%i,%i,%i), (%i,%i,%i) )',l1,l2,l3,m1,m2,m3));
                        pause;
                        close(hf1);
                        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                    end
                end
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
            end
        end
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



